<section class="chat">
  <div class="section-header">
    <div>
      <h1>Chat with Bernard</h1>
      <p class="muted">Sends live requests to {{ endpointLabel() || '/v1/chat/completions' }}.</p>
    </div>
    <div class="section-actions">
      <button
        pButton
        type="button"
        icon="pi pi-refresh"
        label="New conversation"
        severity="secondary"
        (click)="resetConversation()"
      ></button>
    </div>
  </div>

  <div class="config" aria-label="Chat configuration">
    <div class="field">
      <label for="endpoint">API endpoint</label>
      <input
        id="endpoint"
        pInputText
        placeholder="http://localhost:3000/api/v1/chat/completions"
        autocomplete="url"
        [formControl]="form.controls.endpoint"
      />
      <small class="muted">Defaults to the running Bernard instance (/v1/chat/completions).</small>
    </div>
    <div class="field">
      <label for="token">Bearer token (optional)</label>
      <input
        id="token"
        type="password"
        pInputText
        placeholder="Paste a Bernard token or leave blank to use your session"
        autocomplete="off"
        [formControl]="form.controls.token"
      />
      <small class="muted">When empty, the admin session cookie will be used.</small>
    </div>
  </div>

  @if (error()) {
    <p-message severity="error" [text]="error() ?? ''" styleClass="w-full"></p-message>
  }

  <div class="chat-frame" aria-live="polite">
    <deep-chat
      #deepChat
      class="deep-chat-host"
      [style.width.%]="100"
      [style.maxWidth.%]="100"
      [connect]="connectConfig()"
      [chatStyle]="chatStyle"
      [messageStyles]="messageStyles"
      [textInput]="textInputConfig"
      [errorMessages]="errorMessages"
      [submitButtonStyles]="submitButtonStyles"
    ></deep-chat>
  </div>
</section>


